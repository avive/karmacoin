
º‘
!karma_coin/core_types/types.protokarma_coin.core_types"
	AccountId
data (Rdata"y
Balance
free (Rfree
reserved (Rreserved
misc_frozen (R
miscFrozen

fee_frozen (R	feeFrozen"
	PublicKey
key (Rkey"

PrivateKey
key (Rkey"ç
PreKey9
pub_key (2 .karma_coin.core_types.PublicKeyRpubKey
id (Rid8
scheme (2 .karma_coin.core_types.KeySchemeRscheme"»
KeyPairB
private_key (2!.karma_coin.core_types.PrivateKeyR
privateKey?

public_key (2 .karma_coin.core_types.PublicKeyR	publicKey8
scheme (2 .karma_coin.core_types.KeySchemeRscheme"c
	Signature8
scheme (2 .karma_coin.core_types.KeySchemeRscheme
	signature (R	signature"&
MobileNumber
number (	Rnumber"‡
User?

account_id (2 .karma_coin.core_types.AccountIdR	accountId
nonce (Rnonce
	user_name (	RuserNameH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber
balance (RbalanceD
trait_scores (2!.karma_coin.core_types.TraitScoreRtraitScores8
pre_keys (2.karma_coin.core_types.PreKeyRpreKeys
karma_score (R
karmaScore_
community_memberships	 (2*.karma_coin.core_types.CommunityMembershipRcommunityMemberships"ÿ
Contact
	user_name (	RuserName?

account_id (2 .karma_coin.core_types.AccountIdR	accountIdH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber_
community_memberships (2*.karma_coin.core_types.CommunityMembershipRcommunityMembershipsD
trait_scores (2!.karma_coin.core_types.TraitScoreRtraitScores"t
CommunityMembership!
community_id (RcommunityId
karma_score (R
karmaScore
is_admin (RisAdmin"Æ
LeaderboardEntry
	user_name (	RuserName?

account_id (2 .karma_coin.core_types.AccountIdR	accountId
score (Rscore&
char_traits_ids (RcharTraitsIds"d
PhoneVerifier?

account_id (2 .karma_coin.core_types.AccountIdR	accountId
name (	Rname"Ê
Block
time (Rtime8
author (2 .karma_coin.core_types.AccountIdRauthor
height (Rheight/
transactions_hashes (RtransactionsHashes
fees (Rfees*
prev_block_digest (RprevBlockDigest>
	signature (2 .karma_coin.core_types.SignatureR	signature
reward (Rreward
minted	 (Rminted
digest
 (Rdigest"E
	CharTrait
id (Rid
name (	Rname
emoji (	Remoji"`

TraitScore
trait_id (RtraitId
score (Rscore!
community_id (RcommunityId"≤
	Community
id (Rid
name (	Rname
desc (	Rdesc
emoji (	Remoji
website_url (	R
websiteUrl
twitter_url (	R
twitterUrl
	insta_url (	RinstaUrl
face_url (	RfaceUrl
discord_url	 (	R
discordUrl$
char_trait_ids
 (RcharTraitIds
closed (Rclosed"y
NewUserTransactionV1a
verify_number_response (2+.karma_coin.core_types.UserVerificationDataRverifyNumberResponse"≥
PaymentTransactionV14
from (2 .karma_coin.core_types.AccountIdRfrom
amount (Ramount@
	to_number (2#.karma_coin.core_types.MobileNumberRtoNumberD
to_account_id (2 .karma_coin.core_types.AccountIdRtoAccountId"
char_trait_id (RcharTraitId!
community_id (RcommunityId"‚
UpdateUserTransactionV1
nickname (	RnicknameH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumbera
user_verification_data (2+.karma_coin.core_types.UserVerificationDataRuserVerificationData"
DeleteUserTransactionV1"¡
TransactionBody
	timestamp (R	timestamp
nonce (Rnonce
fee (RfeeQ
transaction_data (2&.karma_coin.core_types.TransactionDataRtransactionData
net_id (RnetId"è
TransactionData)
transaction_data (RtransactionDataQ
transaction_type (2&.karma_coin.core_types.TransactionTypeRtransactionType"∏
SignedTransaction8
signer (2 .karma_coin.core_types.AccountIdRsigner)
transaction_body (RtransactionBody>
	signature (2 .karma_coin.core_types.SignatureR	signature"›
UserVerificationDataP
verifier_account_id (2 .karma_coin.core_types.AccountIdRverifierAccountId
	timestamp (R	timestampZ
verification_result (2).karma_coin.core_types.VerificationResultRverificationResult?

account_id (2 .karma_coin.core_types.AccountIdR	accountIdH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber.
requested_user_name (	RrequestedUserName>
	signature (2 .karma_coin.core_types.SignatureR	signature"2
SignedTransactionsHashes
hashes (Rhashes"W
MemPoolL
transactions (2(.karma_coin.core_types.SignedTransactionRtransactions"â
SignedTransactionWithStatusJ
transaction (2(.karma_coin.core_types.SignedTransactionRtransaction@
status (2(.karma_coin.core_types.TransactionStatusRstatus/
from (2.karma_coin.core_types.UserRfrom+
to (2.karma_coin.core_types.UserRto"Ù
TransactionEvent
	timestamp (R	timestamp
height (RheightJ
transaction (2(.karma_coin.core_types.SignedTransactionRtransaction)
transaction_hash (RtransactionHash>
result (2&.karma_coin.core_types.ExecutionResultRresult8
info (2$.karma_coin.core_types.ExecutionInfoRinfo#
error_message (	RerrorMessage9
fee_type (2.karma_coin.core_types.FeeTypeRfeeType#
signup_reward	 (RsignupReward'
referral_reward
 (RreferralReward=
appreciation_char_trait_idx (RappreciationCharTraitIdx:
appreciation_community_id (RappreciationCommunityId
fee (Rfee"T
TransactionEvents?
events (2'.karma_coin.core_types.TransactionEventRevents"Æ
BlockchainStats&
last_block_time (RlastBlockTime

tip_height (R	tipHeight-
transactions_count (RtransactionsCount>
payments_transactions_count (RpaymentsTransactionsCountH
 appreciations_transactions_count (RappreciationsTransactionsCount
users_count (R
usersCount
fees_amount (R
feesAmount#
minted_amount (RmintedAmount 
circulation	 (Rcirculation$
fee_subs_count
 (RfeeSubsCount&
fee_subs_amount (RfeeSubsAmount0
signup_rewards_count (RsignupRewardsCount2
signup_rewards_amount (RsignupRewardsAmount4
referral_rewards_count (RreferralRewardsCount6
referral_rewards_amount (RreferralRewardsAmount6
validator_rewards_count (RvalidatorRewardsCount8
validator_rewards_amount (RvalidatorRewardsAmountC
update_user_transactions_count (RupdateUserTransactionsCount#
exchange_rate (RexchangeRate2
causes_rewards_amount (RcausesRewardsAmount.
karma_rewards_count (RkarmaRewardsCount0
karma_rewards_amount (RkarmaRewardsAmount"¡

BlockEvent
	timestamp (R	timestamp
height (Rheight

block_hash (R	blockHashX
transactions_events (2'.karma_coin.core_types.TransactionEventRtransactionsEvents#
signups_count (RsignupsCount%
payments_count (RpaymentsCount/
appreciations_count (RappreciationsCount,
user_updates_count (RuserUpdatesCount
fees_amount	 (R
feesAmount2
signup_rewards_amount
 (RsignupRewardsAmount6
referral_rewards_amount (RreferralRewardsAmount4
referral_rewards_count (RreferralRewardsCount
reward (Rreward"¸
GenesisData
net_id (RnetId
net_name (	RnetName!
genesis_time (RgenesisTime;
signup_reward_phase1_alloc (RsignupRewardPhase1Alloc;
signup_reward_phase2_alloc (RsignupRewardPhase2Alloc=
signup_reward_phase1_amount (RsignupRewardPhase1Amount=
signup_reward_phase2_amount (RsignupRewardPhase2Amount;
signup_reward_phase3_start (RsignupRewardPhase3Start?
referral_reward_phase1_alloc	 (RreferralRewardPhase1Alloc?
referral_reward_phase2_alloc
 (RreferralRewardPhase2AllocA
referral_reward_phase1_amount (RreferralRewardPhase1AmountA
referral_reward_phase2_amount (RreferralRewardPhase2Amount;
tx_fee_subsidy_max_per_user (RtxFeeSubsidyMaxPerUser3
tx_fee_subsidies_alloc (RtxFeeSubsidiesAlloc8
tx_fee_subsidy_max_amount (RtxFeeSubsidyMaxAmount.
block_reward_amount (RblockRewardAmount5
block_reward_last_block (RblockRewardLastBlock.
karma_reward_amount (RkarmaRewardAmount,
karma_reward_alloc (RkarmaRewardAlloc6
karma_reward_top_n_users (RkarmaRewardTopNUsers:
karma_rewards_eligibility (RkarmaRewardsEligibility;
karma_rewards_period_hours (RkarmaRewardsPeriodHours4
validators_pool_amount (RvalidatorsPoolAmount;
validators_pool_account_id (	RvalidatorsPoolAccountId?
validators_pool_account_name (	RvalidatorsPoolAccountNameA
char_traits (2 .karma_coin.core_types.CharTraitR
charTraitsB
	verifiers (2$.karma_coin.core_types.PhoneVerifierR	verifiers*#
	KeyScheme
KEY_SCHEME_ED25519 *û
TransactionType
TRANSACTION_TYPE_PAYMENT_V1  
TRANSACTION_TYPE_NEW_USER_V1#
TRANSACTION_TYPE_UPDATE_USER_V1#
TRANSACTION_TYPE_DELETE_USER_V1*£
VerificationResult#
VERIFICATION_RESULT_UNSPECIFIED '
#VERIFICATION_RESULT_USER_NAME_TAKEN 
VERIFICATION_RESULT_VERIFIED"
VERIFICATION_RESULT_UNVERIFIED$
 VERIFICATION_RESULT_MISSING_DATA)
%VERIFICATION_RESULT_INVALID_SIGNATURE(
$VERIFICATION_RESULT_ACCOUNT_MISMATCH*Ω
TransactionStatus
TRANSACTION_STATUS_UNKNOWN $
 TRANSACTION_STATUS_NOT_SUBMITTED 
TRANSACTION_STATUS_SUBMITTED
TRANSACTION_STATUS_REJECTED
TRANSACTION_STATUS_ON_CHAIN*/
FeeType
FEE_TYPE_MINT 
FEE_TYPE_USER*N
ExecutionResult
EXECUTION_RESULT_EXECUTED 
EXECUTION_RESULT_INVALID*§
ExecutionInfo
EXECUTION_INFO_UNKNOWN #
EXECUTION_INFO_NICKNAME_UPDATED)
%EXECUTION_INFO_NICKNAME_NOT_AVAILABLE#
EXECUTION_INFO_NICKNAME_INVALID!
EXECUTION_INFO_NUMBER_UPDATED"
EXECUTION_INFO_ACCOUNT_CREATED$
 EXECUTION_INFO_PAYMENT_CONFIRMED
EXECUTION_INFO_INVALID_DATA)
%EXECUTION_INFO_ACCOUNT_ALREADY_EXISTS!
EXECUTION_INFO_TX_FEE_TOO_LOW	&
"EXECUTION_INFO_INTERNAL_NODE_ERROR
J—Ö
 ß
®
 2ù Copyright (c) 2022, KarmaCoin Authors. a@karmaco.in.
 This work is licensed under the KarmaCoin v0.1.0 license published in the LICENSE file of this repo.



 
E
 
  Derived from a public key
2 Basic KarmaCoin data types



 


  

  	

  


  
)
   Supported signature schemes



 

  

  

  


 




 

 


 

 



























&
  An public encryption key





 

 	

 


 


 !




  

  	

  


  


# '


#

 $

 $

 $

 $

%

%


%

%

&

&

&

&


) -


)

 *

 *

 *

 *

+

+

+

+

,

,

,

,


/ 2


/

 0

 0

 0

 0

1

1	

1


1


4 7


4
B
 65 always up to 12 digits which including country code


 6


 6

 6
 
: F user on-chain data



:
3
 ;"& account id derived from a public key


 ;

 ;

 ;

<

<


<

<
'
=" unique across the system


=


=

=
&
>#" verified current number


>

>

>!"

?

?


?

?

@)

@

@

@$

@'(
6
A!") one-time enc pre-keys for e2e messaging


A

A

A

A 
)
B" user's current karma score


B


B

B
P
E;C all communities user is member of, admin rights and score in each


E

E 

E!6

E9:
Q
	I OE Contact information for easy appreciation in the app of any contact



	I

	 J

	 J


	 J

	 J

	K

	K

	K

	K

	L#

	L

	L

	L!"

	M;

	M

	M 

	M!6

	M9:

	N)

	N

	N

	N$

	N'(



Q V



Q


 R


 R



 R


 R


S


S



S


S
E

U8 when true user is admin of the community - set by sudo



U


U	


U


X _


X

 Y

 Y


 Y

 Y

Z

Z

Z

Z
#
\ score in leaderboard


\


\

\
1
^($ outgoing appreciations char traits


^

^

^#

^&'
T
c fH Phone verifier is an entity that verifies account mobile phone numbers



c
"
 d" verifier account id


 d

 d

 d

e

e


e

e


h s


h

 i

 i


 i

 i

j

j

j

j

k

k


k

k
7
l+"* of the signed transactions in this block


l

l

l&

l)*
,
m" total fees paid in this block


m


m

m
B
n "5 digest of block in consensus at the previous height


n	

n


n

o'

o

o"

o%&

p

p


p

p
L
q"? total coins minted in this block (rewards + tx fee subsidies)


q


q

q
;
	r". block digest includes hash of all above data


	r	

	r


	r


u y


u

 v

 v


 v

 v

w

w


w

w

x

x


x

x

{ Ä


{

 |

 |


 |

 |

}

}


}

}
Q
D 0 for no community, otherwise community id this trait was assigned








#
É ë a community partner


É

 Ñ

 Ñ


 Ñ

 Ñ

Ö

Ö


Ö

Ö

Ü

Ü


Ü

Ü

á

á


á

á

à

à


à

à

â

â


â

â

ä

ä


ä

ä

ã

ã


ã

ã

å

å


å

å

	ç(

	ç

	ç

	ç"

	ç%'
ç

ê closed community - only community manager can invite new members
 and only members can appreciate each other in the community



ê


ê	


ê

î ô/ transactions


î

 ï$

 ï

 ï"#

ñ%

ñ 

ñ#$

ó(

ó#

ó&'

ò(

ò#

ò&'
8
ú ü* new user transactions submitted by users


ú
A
 û43 Evidence from a valid verifier about the new user


 û

 û/

 û23
ó
£ ¨à Basic payment transaction with optional character appreciation
 Receiver must be identified by phone number or a karma coin account id


£
X
 §"J must be included so it is part of signed message and part of the tx hash


 §

 §

 §
,
•" amount in tokens to transfer


•


•

•
§
®| IMPORTANT: one of the next fields must be provided as the payee for the tx to be valid
 todo: use oneof proto feature here
" pay to a mobile number


®

®

®
.
© "  pay to a Karma Coin account id


©

©

©
7
™") char trait id set by sender. e.g. smart


™


™

™

´

´


´

´
‹
µ øÕ Update user info
 User can update his nickname, mobile phone number or accountId in case
 he wants to associate his number with a new accountId.
 in that case, only way to transact from old account with old account id is via
 payment transactions from an accountId signed by this accountId private key
 Also in this case a new onchain account should be created with the new accountId
 and the user's phone number is going to be assoicated with the new account


µ
&
 ∏ new requested nickname


 ∏


 ∏

 ∏
5
ª#' Updated mobile number or existing one


ª

ª

ª!"
I
æ4; verifier attestation regarding the number and the account


æ

æ/

æ23

¡ ¬

¡
:
≈ À, The generic transaction payload - unsigned


≈
+
 ∆" time transaction was signed


 ∆


 ∆

 ∆

«"
 tx nonce


«


«

«
.
»"  network fee provided by sender


»


»

»
'
…)" binary transaction data


…

…$

…'(
;
 "- network id to avoid confusion with testnets


 


 

 
+
Œ — serialized transaction data


Œ
M
 œ"? binary transaction data (e.g. NewUserTxV1, PaymentV1, etc...)


 œ	

 œ


 œ
4
–)"& transaction type for deserialization


–

–$

–'(

” ◊

”
,
 ‘" account this tx is signed by


 ‘

 ‘

 ‘
 
’" Transaction data


’	

’


’
9
÷"+ signer signature on all of the above data


÷

÷

÷

Ÿ ·

Ÿ

 ⁄(

 ⁄#

 ⁄&'
C
€,"5 there's already a user with the requested user name


€'

€*+
5
‹%"' user is verified using provided token


‹ 

‹#$
9
›'"+ user is not verifier using provided token


›"

›%&
0
ﬁ)"" request is missing required data


ﬁ$

ﬁ'(
$
ﬂ." bad client signature


ﬂ)

ﬂ,-
>
‡-"0 different account associated with phone number


‡(

‡+,
_
‰ ÏQ Created and signed by a verifier to attest that an account owns a mobile number


‰

 Â&

 Â

 Â!

 Â$%

Ê

Ê


Ê

Ê

Á/

Á

Á*

Á-.

Ë

Ë

Ë

Ë

È#

È

È

È!"

Í#

Í


Í

Í!"

Î

Î

Î

Î

Ó Ù

Ó

 Ô#

 Ô

 Ô!"

)

$

'(

Ò%

Ò 

Ò#$

Ú$

Ú

Ú"#

Û$

Û

Û"#
3
˜ ˘% a collection of signed transactions


˜ 

 ¯

 ¯

 ¯

 ¯

 ¯
O
¸ ˛A Pending transactions are transactions that are not yet on chain


¸

 ˝0

 ˝

 ˝

 ˝+

 ˝./

Ä Ö

Ä#

 Å&

 Å

 Å!

 Å$%
"
Ç!" transaction status


Ç

Ç

Ç 

É" sender


É

É

É

Ñ"
 receiver


Ñ

Ñ

Ñ

á ä

á
,
 à" fee provided by the protocol


 à

 à
6
â"( fee provided by the transaction signer


â

â
+
ç õ Transaction added to ledger


ç

 é

 é


 é

 é
*
è" ledger height of execution


è


è

è

ê&

ê

ê!

ê$%

ë

ë	

ë


ë

í

í

í

í

ì

ì

ì

ì

î

î


î

î

ï

ï

ï

ï

ñ

ñ


ñ

ñ

	ó 

	ó


	ó

	ó


ò,


ò



ò&


ò)+

ô*

ô


ô$

ô')

ö

ö


ö

ö
8
û †* A collection of events for a transaction


û

 ü)

 ü

 ü

 ü$

 ü'(
*
£ ‹ Blockchain aggregated data


£
*
 ¶ last block production time


 ¶


 ¶

 ¶
$
© current block height


©


©

©
5
¨"' total number of executed transactions


¨


¨

¨ !
4
Ø+& total number of payment transactions


Ø


Ø&

Ø)*
I
≤0; total number of payment transactions with an appreciation


≤


≤+

≤./
6
µ( total number of verified user accounts


µ


µ

µ
:
∏, total tx fees collected by block producers


∏


∏

∏
K
ª= total number of kCents minted by the protocol since genesis


ª


ª

ª
X
æJ total number of kCents in circulation by minting. Not including pre-mint


æ


æ

æ
=
	¡/ total tx fee subsidies issued by the protocol


	¡


	¡

	¡


¬ 


¬



¬


¬

ƒ%

ƒ


ƒ

ƒ"$

≈&

≈


≈ 

≈#%

«'

«


«!

«$&

»(

»


»"

»%'

 (

 


 "

 %'

À)

À


À#

À&(
4
Œ/& total number of payment transactions


Œ


Œ)

Œ,.
1
—# estimated KC to USD exchange rate


—


—

—
0
‘&" amount of rewards paid to causes


‘


‘ 

‘#%
#
◊$ karma rewards given


◊


◊

◊!#
.
⁄%  karma rewards amount allocated


⁄


⁄

⁄"$

ﬂ Ì Block events


ﬂ

 ‡

 ‡


 ‡

 ‡

·

·


·

·

‚

‚	

‚


‚

„6

„

„

„1

„45

‰

‰


‰

‰

Â

Â


Â

Â

Ê#

Ê


Ê

Ê!"

Á"

Á


Á

Á !

Ë

Ë


Ë

Ë

	È&

	È


	È 

	È#%


Í(


Í



Í"


Í%'

Î'

Î


Î!

Î$&

Ï

Ï


Ï

Ï

Ô Ú

Ô

 "

 

  !

Ò!" invalid syntax


Ò

Ò 

Ù Ä

Ù

 ı

 ı

 ı

ˆ(

ˆ#

ˆ&'

˜.

˜)

˜,-

¯(

¯#

¯&'

˘&

˘!

˘$%

˙'

˙"

˙%&

˚)

˚$

˚'(

¸$

¸

¸"#

˝.

˝)

˝,-

	˛&

	˛!

	˛$%


ˇ,


ˇ&


ˇ)+

 Ç ß

 Ç

  É

  É


  É

  É

 Ñ

 Ñ


 Ñ

 Ñ

 Ö

 Ö


 Ö

 Ö

 Ü*

 Ü


 Ü%

 Ü()

 á*

 á


 á%

 á()

 â+

 â


 â&

 â)*

 ä+

 ä


 ä&

 ä)*

 ã*

 ã


 ã%

 ã()

 ç,

 ç


 ç'

 ç*+

 	é-

 	é


 	é'

 	é*,

 
ê.

 
ê


 
ê(

 
ê+-

 ë.

 ë


 ë(

 ë+-

 ì,

 ì


 ì&

 ì)+

 î'

 î


 î!

 î$&

 ï*

 ï


 ï$

 ï')

 ó$

 ó


 ó

 ó!#

 ò(

 ò


 ò"

 ò%'

 ö$

 ö


 ö

 ö!#

 õ#

 õ


 õ

 õ "

 ú)

 ú


 ú#

 ú&(

 ù*

 ù


 ù$

 ù')

 û+

 û


 û%

 û(*

 †'

 †


 †!

 †$&

 °+

 °


 °%

 °(*

 ¢-

 ¢


 ¢'

 ¢*,

 §3

 §

 §!

 §"-

 §02

 •5

 •

 •%

 •&/

 •24bproto3
Ä
$karma_coin/core_types/verifier.protokarma_coin.verifier!karma_coin/core_types/types.proto"ﬂ
VerifierInfo
name (	Rname?

account_id (2 .karma_coin.core_types.AccountIdR	accountId2
verifier_endpoint_ip4 (	RverifierEndpointIp42
verifier_endpoint_ip6 (	RverifierEndpointIp6(
api_endpoint_ip4 (	RapiEndpointIp4(
api_endpoint_ip6 (	RapiEndpointIp6>
	signature (2 .karma_coin.core_types.SignatureR	signature"y
VerifyNumberResponsea
user_verification_data (2+.karma_coin.core_types.UserVerificationDataRuserVerificationData"Æ
VerifyNumberRequest
	timestamp (R	timestamp?

account_id (2 .karma_coin.core_types.AccountIdR	accountIdH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber.
requested_user_name (	RrequestedUserName>
	signature (2 .karma_coin.core_types.SignatureR	signature"∏
SmsInviteMetadataH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber>
last_message_sent_time_stamp (RlastMessageSentTimeStamp#
messages_sent (RmessagesSentN
inviter_account_id (2 .karma_coin.core_types.AccountIdRinviterAccountId$
invite_tx_hash (RinviteTxHash2v
VerifierServicec
VerifyNumber(.karma_coin.verifier.VerifyNumberRequest).karma_coin.verifier.VerifyNumberResponseJ÷
 3
®
 2ù Copyright (c) 2022, KarmaCoin Authors. a@karmaco.in.
 This work is licensed under the KarmaCoin v0.1.0 license published in the LICENSE file of this repo.



 
	
  +
7
 
 + mobile phone numbers verifier api service



 

∞
  G¢ Request to verify a number by providing code sent via sms from verifier
 note that VerifyNumberResponse was lifted to types as it is used in signup transactions


  

  &

  1E
b
  V Verier Info is used to return the network the id and dialup info of active verifiers



 

  

  

  	

  

 &

 

 !

 $%

 #"	 ip:port


 

 	

 !"

 #"	 ip:port


 

 	

 !"

 "	 ip:port


 

 	

 

 "	 ip:port


 

 	

 

 %

 

  

 #$


 




 =

 !

 "8

 ;<


 %




  

  

  	

  

!&

!

!!

!$%

",

"

"'

"*+

#!

#

#	

# 

$%

$

$ 

$#$
D
( 38/ Data object stored in db to track invite sms messages



(
1
 *,$ invited person mobile phone number


 *

 *'

 **+
;
,*. the time of the last invite sms message sent


,

,	%

,()
7
.* total number of invite sms messages sent


.

.	

.
A
0.4 inviter mobile phone number (from appreciation tx)


0

0)

0,-
C
26 the hash of the payment tx that triggers this invite


2

2

2bproto3
ø
 karma_coin/core_types/auth.protokarma_coin.auth!karma_coin/core_types/types.proto"q
AuthRequest?

account_id (2 .karma_coin.core_types.AccountIdR	accountId!
phone_number (	RphoneNumber"C
AuthResponse3
result (2.karma_coin.auth.AuthResultRresult*u

AuthResult"
AUTH_RESULT_USER_AUTHENTICATED 
AUTH_RESULT_USER_NOT_FOUND#
AUTH_RESULT_ACCOUNT_ID_MISMATCH2Z
AuthServiceK
Authenticate.karma_coin.auth.AuthRequest.karma_coin.auth.AuthResponseJ”
 !
®
 2ù Copyright (c) 2022, KarmaCoin Authors. a@karmaco.in.
 This work is licensed under the KarmaCoin v0.1.0 license published in the LICENSE file of this repo.



 
	
  +
ß
  ö/ A simple mini auth service for verifying mobile phone numbers and accounts ids associated with them
/ Implemented in dart using firebase as the backend



 

  7

  

  

  )5


  


 

  &

  

  !

  $%

 

 

 	

 


  


 
N
  %A user is found and accountId is associated with the phone number


   

  #$
0
 !# user is not found by phone number


 

  
Y
 &L user exists but a different account id is associated with the phone number


 !

 $%


 !




  

  

  

  bproto3
¿S
karma_coin/core_types/api.protokarma_coin.api!karma_coin/core_types/types.proto"ñ
SetCommunityAdminRequestH
from_account_id (2 .karma_coin.core_types.AccountIdRfromAccountId
data (Rdata
	signature (R	signature"º
SetCommunityAdminData
	timestamp (R	timestampL
target_account_id (2 .karma_coin.core_types.AccountIdRtargetAccountId!
community_id (RcommunityId
admin (Radmin"
SetCommunityAdminResponse"
GetLeaderBoardRequest"O
GetContactsRequest
prefix (	Rprefix!
community_id (RcommunityId"Q
GetContactsResponse:
contacts (2.karma_coin.core_types.ContactRcontacts"r
GetLeaderBoardResponseX
leaderboard_entries (2'.karma_coin.core_types.LeaderboardEntryRleaderboardEntries"?
 GetTransactionsFromHashesRequest
	tx_hashes (RtxHashes"¬
!GetTransactionsFromHashesResponseV
transactions (22.karma_coin.core_types.SignedTransactionWithStatusRtransactionsE
	tx_events (2(.karma_coin.core_types.TransactionEventsRtxEvents"7
GetAllUsersRequest!
community_id (RcommunityId"H
GetAllUsersResponse1
users (2.karma_coin.core_types.UserRusers"
GetExchangeRateRequest">
GetExchangeRateResponse#
exchange_rate (RexchangeRate";
GetUserInfoByUserNameRequest
	user_name (	RuserName"P
GetUserInfoByUserNameResponse/
user (2.karma_coin.core_types.UserRuser"f
SubmitTransactionRequestJ
transaction (2(.karma_coin.core_types.SignedTransactionRtransaction"Ä
SubmitTransactionResponsec
submit_transaction_result (2'.karma_coin.api.SubmitTransactionResultRsubmitTransactionResult"f
GetUserInfoByNumberRequestH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber"N
GetUserInfoByNumberResponse/
user (2.karma_coin.core_types.UserRuser"^
GetUserInfoByAccountRequest?

account_id (2 .karma_coin.core_types.AccountIdR	accountId"O
GetUserInfoByAccountResponse/
user (2.karma_coin.core_types.UserRuser"
GetGenesisDataRequest"_
GetGenesisDataResponseE
genesis_data (2".karma_coin.core_types.GenesisDataRgenesisData"
GetBlockchainDataRequest"Y
GetBlockchainDataResponse<
stats (2&.karma_coin.core_types.BlockchainStatsRstats"Y
GetTransactionsRequest?

account_id (2 .karma_coin.core_types.AccountIdR	accountId"∏
GetTransactionsResponseV
transactions (22.karma_coin.core_types.SignedTransactionWithStatusRtransactionsE
	tx_events (2(.karma_coin.core_types.TransactionEventsRtxEvents"0
GetTransactionRequest
tx_hash (RtxHash"µ
GetTransactionResponseT
transaction (22.karma_coin.core_types.SignedTransactionWithStatusRtransactionE
	tx_events (2(.karma_coin.core_types.TransactionEventsRtxEvents"p
GetBlockchainEventsRequest*
from_block_height (RfromBlockHeight&
to_block_height (RtoBlockHeight"e
GetBlockchainEventsResponseF
blocks_events (2!.karma_coin.core_types.BlockEventRblocksEvents"f
GetBlocksRequest*
from_block_height (RfromBlockHeight&
to_block_height (RtoBlockHeight"I
GetBlocksResponse4
blocks (2.karma_coin.core_types.BlockRblocks*j
SubmitTransactionResult&
"SUBMIT_TRANSACTION_RESULT_REJECTED '
#SUBMIT_TRANSACTION_RESULT_SUBMITTED2≠

ApiServicej
SetCommunityAdmin(.karma_coin.api.SetCommunityAdminRequest).karma_coin.api.SetCommunityAdminResponse" a
GetLeaderBoard%.karma_coin.api.GetLeaderBoardRequest&.karma_coin.api.GetLeaderBoardResponse" X
GetAllUsers".karma_coin.api.GetAllUsersRequest#.karma_coin.api.GetAllUsersResponse" X
GetContacts".karma_coin.api.GetContactsRequest#.karma_coin.api.GetContactsResponse" Ç
GetTransactionsFromHashes0.karma_coin.api.GetTransactionsFromHashesRequest1.karma_coin.api.GetTransactionsFromHashesResponse" t
GetUserInfoByUserName,.karma_coin.api.GetUserInfoByUserNameRequest-.karma_coin.api.GetUserInfoByUserNameResponsen
GetUserInfoByNumber*.karma_coin.api.GetUserInfoByNumberRequest+.karma_coin.api.GetUserInfoByNumberResponseq
GetUserInfoByAccount+.karma_coin.api.GetUserInfoByAccountRequest,.karma_coin.api.GetUserInfoByAccountResponseh
GetBlockchainData(.karma_coin.api.GetBlockchainDataRequest).karma_coin.api.GetBlockchainDataResponse_
GetGenesisData%.karma_coin.api.GetGenesisDataRequest&.karma_coin.api.GetGenesisDataResponseh
SubmitTransaction(.karma_coin.api.SubmitTransactionRequest).karma_coin.api.SubmitTransactionResponseb
GetTransactions&.karma_coin.api.GetTransactionsRequest'.karma_coin.api.GetTransactionsResponse_
GetTransaction%.karma_coin.api.GetTransactionRequest&.karma_coin.api.GetTransactionResponsep
GetBlockchainEvents*.karma_coin.api.GetBlockchainEventsRequest+.karma_coin.api.GetBlockchainEventsResponse" R
	GetBlocks .karma_coin.api.GetBlocksRequest!.karma_coin.api.GetBlocksResponse" J‹-
 ÿ
®
 2ù Copyright (c) 2022, KarmaCoin Authors. a@karmaco.in.
 This work is licensed under the KarmaCoin v0.1.0 license published in the LICENSE file of this repo.



 
	
  +
K
 
 B? Unified public API provided by blockchain nodes and verifiers



 

ù
  é make another user a community admin. Can only be executed by an existing community admin
 in Karmachain 2.0 this will need to come from sudo


  

  0

  ;T
<
 . get current karma rewards period leaderboard


 

 *

 5K
X
 J return all accounts on chain - doesn't support pagination yet but should


 

 $

 /B
Ä
 r get contacts for easy appreciation from app of any existing user. should support pagination and prefix filtering


 

 $

 /B
D
 6 Return transactions for provided one or more tx hash


 

  @

 Kl
/
 "b" check if a username is available


 "

 "8

 "C`
H
 %\; Returns on-chain user info by phone number if user exists


 %

 %4

 %?Z
F
 (_9 Returns on-chain user info by account id if user exists


 (

 (6

 (A]
3
 +V& Returns the current blockchain state


 +

 +0

 +;T
3
 	.M& Returns the current blockchain state


 	.

 	.*

 	.5K
<
 
1V/ Submit a signed transaction to the blockchain


 
1

 
10

 
1;T
¿
 5P≤ Get all transactions between two account, included transactions in the pool and not yet on-chain
 Results include txs current status and all events omitted for each transaction


 5

 5,

 57N
ì
 9MÖ Get transaction data by its digest hash. Transaction may be in pool or on-chain
 Returns all events associated with the transaction


 9

 9*

 95K
<
 <=. Get blockchain events for a range of heights


 <

 <4

 <?Z
<
 @A. Get blockchain events for a range of heights


 @

 @ 

 @+<


 D J


 D 
H
  F+; Caller serialized SetCommunityAdminData protobufs message


  F

  F&

  F)*

 G

 G

 G

 G
+
 I Caller signature on the data


 I

 I

 I


L Q


L

 M

 M

 M	

 M

N-

N

N(

N+,

O

O

O	

O

P

P

P

P


S T


S!


V X


V


Z ]


Z
I
 ["< optional prefix over user names for auto-complete purposes


 [

 [	

 [
-
\"  optional filter by a community


\

\	

\


_ a


_

 `+

 `


 `

 `&

 `)*


d f


d

 e?

 e


 e&

 e':

 e=>


h j


h(

 i

 i


 i

 i

 i


l o


l)

 mC

 m


 m1

 m2>

 mAB

n-

n

n(

n+,


	q s


	q

	 r

	 r

	 r	

	 r



u w



u


 v%


 v



 v


 v 


 v#$


y z


y


| 


|
*
 ~ Estimated 1 KC value in USD


 ~

 ~	

 ~
%
Ç Ñ Get user by user name


Ç$

 É

 É

 É	

 É

Ü à

Ü%

 á

 á

 á

 á

ä å

ä 

 ã2

 ã!

 ã"-

 ã01

 é ë

 é

  è)

  è$

  è'(

 ê*

 ê%

 ê()

ì ï

ì!

 î8

 î

 î3

 î67

ó ô

ó"

 ò,

 ò

 ò'

 ò*+

õ ù

õ#

 ú

 ú

 ú

 ú

ü °

ü#

 †&

 †

 †!

 †$%

£ •

£$

 §

 §

 §

 §

ß ®

ß

™ ¨

™

 ´*

 ´

 ´%

 ´()

Æ Ø

Æ 
'
≤ ¥ Current blockchain data


≤!

 ≥'

 ≥

 ≥"

 ≥%&

∂ ∏

∂

 ∑&

 ∑

 ∑!

 ∑$%

∫ Ω

∫

 ªC

 ª


 ª1

 ª2>

 ªAB

º-

º

º(

º+,

ø ¡

ø

 ¿

 ¿

 ¿

 ¿

√ ∆

√

 ƒ9

 ƒ(

 ƒ)4

 ƒ78

≈-

≈

≈(

≈+,

» À

»"

 …

 …

 …	

 …

 

 

 	

 

Õ œ

Õ#

 Œ3

 Œ


 Œ 

 Œ!.

 Œ12

— ‘

—

 “

 “

 “	

 “

”

”

”	

”

 ÷ ÿ

 ÷

  ◊'

  ◊


  ◊

  ◊"

  ◊%&bproto3
¡
karma_coin/client.protokarma_coin.client!karma_coin/core_types/types.proto".
ConfigureRequest
nickname (	Rnickname"
ConfigureResponse"±
SignUpRequest+
verifier_endpoint (	RverifierEndpoint!
api_endpoint (	RapiEndpointP
verifier_account_id (2 .karma_coin.core_types.AccountIdRverifierAccountId"
SignUpResponse"
GetAccountStateRequest"
UpdatePhoneNumberRequest"
UpdatePhoneNumberResponse"
UpdateUserInfoRequest"
UpdateUserInfoResponse"∆
SendCoinRequestH
mobile_number (2#.karma_coin.core_types.MobileNumberRmobileNumber
amount (Ramount
fee (Rfee?

char_trait (2 .karma_coin.core_types.CharTraitR	charTrait"
SendCoinResponse"ò
GetAccountStateResponse/
user (2.karma_coin.core_types.UserRuserL
transactions (2(.karma_coin.core_types.SignedTransactionRtransactions2·
	ClientApiX
	Configure#.karma_coin.client.ConfigureRequest$.karma_coin.client.ConfigureResponse" O
SignUp .karma_coin.client.SignUpRequest!.karma_coin.client.SignUpResponse" g
UpdateUserInfo(.karma_coin.client.UpdateUserInfoRequest).karma_coin.client.UpdateUserInfoResponse" U
SendCoin".karma_coin.client.SendCoinRequest#.karma_coin.client.SendCoinResponse" i
GetAccountData).karma_coin.client.GetAccountStateRequest*.karma_coin.client.GetAccountStateResponse" J˙
  a

  

 
	
  +


  


 

  " user's nickname


  

  	

  


 






 



4
 "' verifier grpc endpoint. e.g [:1]:5438


 

 	

 
5
"( karmacoin api endpoint. e.g. [:1]:2351




	


9
/", verifier account id that should be trusted




*

-.


 





 





 


 


  


!


" $


"


& (


&


	* 6


	*
-
	 ,,  receiver's mobile phone number


	 ,

	 ,'

	 ,*+

	/ amount to send


	/

	/	

	/

	2 transaction fee


	2

	2	

	2
'
	5& char trait to appreciate


	5

	5!

	5$%



8 :



8


< C


<
F
 >9 public user info includes balances, karma score, etc...


 >

 >

 >
F
A99 all transactions known to client for the user's account


A


A'

A(4

A78
W
 F aK A simple client API used for instrumenting a client and integration tests



 F
5
  HJ' Configure the client with config data


  H

  H 

  H+<
+
 MO Sign up using mobile number


 M

 M

 M%3
H
 RT: Update user public info such as nickname or phone number


 R

 R*

 R5K
E
 WY7 Send a coin to another user and optionally appreciate


 W

 W

 W)9
d
 ]_V Get current account state such as balance, karma score, char traits and transactions


 ]

 ]+

 ]6Mbproto3